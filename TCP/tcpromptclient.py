import socket
import os


nombre_de_caracteres = 0



with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
    s.connect(("127.0.0.1", 12345))

    while True:
        data = s.recv(1024)
        if not data:
            s.shutdown(2)
            s.close()
            exit()

        data = data.decode()
        order = ""        
        param = ""
        flag = 1
        for letter in data:
            if(flag == 1):
                if(letter == "#"):
                    flag = 2
                else:
                    order += letter
            else:
                param += letter

        if(order == "LIST"):
            tosend = "-----Listes des fichiers-----\n"
            i = 0
            for file in os.listdir(param):
                tosend += "[" + str(i) + "]" + file + "\n"
                i += 1
            s.sendall(tosend.encode())

        elif(order == "UPLOAD"):
            f = open(param, "r")
            tosend = f.read()
            f.close()
            s.sendall(tosend.encode())
