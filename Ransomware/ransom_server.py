import socket

def connection(server_ip, server_port):
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.bind((server_ip, server_port))
        s.listen()
        conn, addr = s.accept()
        with conn:
            print("Connecté a" + str(addr))
            while True:
                data = conn.recv(1024).decode()
                if not data:
                    break

                key = ""
                uuid = ""
                flag = True
                for lettre in str(data):
                    if lettre == "#":
                        flag = False
                    elif flag:
                        key += lettre
                    else:
                        uuid += lettre

                # Stocker la clé & l'UUID
                f= open("keys.txt", "a")
                f.write("\n\nKey : " + key + "\nUUID : " +  uuid + "\n")
                f.close()
                print("Recu : " + "\nKey : " + key + "\nUUID : " +  uuid)

if __name__ == '__main__':
    connection("127.0.0.1", 12345)