from scapy.all import *
import os

def packet_handler(packet):
    data = packet.load.decode(errors="ignore")

    if (data.startswith("bob#")):
        flag = True
        content = ""
        title = ""
        for char in range(len(data) - 3):
            if (flag == True):
                if (data[char + 3] == "#"):
                    flag = False
                else:
                    title = title + data[char + 3]
            else:
                content += data[char + 4]
        print("Message received : \n Title : " + title + "\nContent : " + content)
    else:
        print("Received wrong packet.")

sniff(iface="lo", filter="icmp", prn=packet_handler)
