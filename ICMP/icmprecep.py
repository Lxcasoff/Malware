from scapy.all import *

# Effacer le contenu du fichier de r√©ception avant de commencer
with open("received_file", "w") as f:
    pass

def packet_handler(packet):
    if packet[IP].src != "127.0.0.1":  # Ignorer les paquets sortants
        if packet.haslayer(ICMP) and packet.haslayer(Raw):
            with open("received_file", "ab") as f:
                f.write(packet[Raw].load)

sniff(iface="lo", filter="icmp", prn=packet_handler)